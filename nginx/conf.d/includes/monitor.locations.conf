  # Atalhos vindos de /monitor
  location = /monitor/area-cliente {
    return 301 /area-cliente/;
  }
  location ^~ /monitor/area-cliente/ {
    return 301 /area-cliente/;
  }

  # ===== MONITOR =====
  # Seu compose: service php-monitor (container php_monitor), porta interna 80
  location = /monitor {
    return 301 /monitor/;
  }
  # Ajuste de CSS para subpath (urls absolutas dentro do CSS)
  location ~* ^/monitor/.*\.css$ {
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto https;
    proxy_set_header X-Forwarded-Prefix /monitor;
    proxy_set_header Accept-Encoding "";

    rewrite ^/monitor/(.*)$ /$1 break;
    proxy_pass http://php-monitor:80;
    sub_filter_once off;
    sub_filter_types text/css;
    sub_filter 'url(/' 'url(/monitor/';
  }
  location /monitor/ {
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto https;
    proxy_set_header X-Forwarded-Prefix /monitor;
    proxy_intercept_errors on;
    # Disable upstream compression so sub_filter can edit responses.
    proxy_set_header Accept-Encoding "";

    # Mantem /monitor/... no upstream. Se o app nao suportar subpath,
    # pode ser necessario reescrever ou usar subdominio no futuro.
    proxy_pass http://php-monitor:80/;
    proxy_redirect ~^(/.*)$ /monitor$1;
    sub_filter_once off;
    sub_filter 'href="/' 'href="/monitor/';
    sub_filter 'src="/' 'src="/monitor/';
    sub_filter 'action="/' 'action="/monitor/';
  }
